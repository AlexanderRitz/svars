{
    "contents" : "####-----------------------------------------####\n#######                                   #######\n#######        Analysis for the USA       ####### \n#######                                   #######\n####----------------------------------------#####\n\nrm(list = ls())\n\n# Loading packages\nlibrary(ggplot2)\nlibrary(vars)\nlibrary(reshape2)\nlibrary(svMisc)\nlibrary(urca)\nlibrary(zoo)\nlibrary('expm')\n\n# Defining the working directory\n#setwd('H:/Guido/Neues_Projekt/Codes/Real_USA/Stationary')\nsetwd('/home/alex/Schreibtisch/Praktikum/DIW/Guido/Guido/Neues_Projekt/Codes/Real_USA/Stationary')\n\n# loading functions\nsource('CovMat.R')\nsource('ImpuldeResponseFunction.R')\nsource('Boot.R')\nsource('PlotShocks.R')\nsource('CoeffMat.R')\nsource('RollingWindow.R')\nsource('Growth.R')\nsource('Analysis.R')\nsource('chow.test.R')\nsource('ChangesVola.R')\nsource('DataGen.R')\nsource('Wald.test.R')\nsource('DataGen2.R')\n\n#---------------------------#\n## Defing Input Parameters ##\n#---------------------------#\n\n## Important inputs analysis\nLagOrder1 <- 'aic' # Lag order for pre period. If 'aic' (default) the lag order is defined by AIC. \n                   # or choose between 2-12 lags\nLagOrder2 <- 'aic' # Lag order for post period. If 'aic' (default) the lag order is defined by AIC.\n                   # or choose between 2-12 lags\nSB <- '1984 Q4'    # Assumed Structural Break\nBeg <- '1957q1'    # Beginning of the series\n\n## Inputs for Bootstrap\nhorizon <- 12      # Number of lags for Impulse response function\nnboot <- 2000       # Number of bootstrap iterations (should be  at least 10000 for consistent result)\nlowerbound <- 0.16 # lower bound for CI\nupperbound <- 0.84 # upper bound for CI\nnTS <- 4           # number of time series\n\n## Logicals if some further analysis should be done\nDataPlot <- T # Data Plot of Series after transformation (These are the series which are estimated)\nRollW <- T    # Rolling window analysis\nStatTest <- T # Testing each series for stationarity at 5% significance level\nSBtest <- T   # testing for the pre determined SB with a chow test at 5% \ndfLags <- 4   # Lag order for dickey fuller stationary test\n\n## Chwo test specification\nClag <- 'aic' # lag order for chow test\nbootC <- F    # if the Chow test statistic should be bootstraped\nnCboot <- 2000 # number of bootstrap replications\n\n#----------------------#\n## Beginning analysis ##\n#----------------------#\n\n############## The common analysis ###############\n# loading Data\nTimeSeries <- read.csv2('/home/alex/Schreibtisch/Praktikum/DIW/Guido/Guido/Neues_Projekt/Daten_Projekt/USA/DataUSAreal.csv')\n#TimeSeries <- read.csv2('H:/Guido/Neues_Projekt/Daten_Projekt/USA/DataUSAreal.csv')\nTimeSeries <- TimeSeries[,1:5]\nTimeSeries <- na.omit(TimeSeries)\n\n## Doing the analysis\nResults <- Analysis()\n\n# Results from Analysis\nResults$Data\nggsave('./Ergebnisse/TSPlot_GDPgrowth.pdf', width = 12, height = 8)\nResults$Impulse\nggsave('./Ergebnisse/Impact_RFI_diff_IR.pdf', width = 12, height = 8)\nsaveRDS(Results$Impulse, file = \"/home/alex/Schreibtisch/Praktikum/DIW/Guido/Guido/Neues_Projekt/Codes/PlotsforPaper/USA.rds\")\nResults$Window\nggsave('./Ergebnisse/RollingWindow_diff_IR.pdf', width = 12, height = 8)\n\n## Analysis for long period with changes in Volatility \nOrdering <- F\nrest <- F\nBoot <- F\nchol.sky <- F\nnlag <- 10\nnames(TimeSeries) <- c('Date', 'I','GDP', 'CPI', 'IR')\nset.seed(41241)\nResult2 <- ChangesVola()\n\n# Impulse Matrix (W) and Matrix with Volatility change (Psi)\nResult2$Psi\nResult2$Psi_SE\nResult2$W\nResult2$W_SE\n# Checking W for zero restrictions\nW <- Result2$W\nsize <- nrow(W)\nalpha <- 0.05\nsig <- qt((1-alpha/2), (Result2$n-1))\nfor(i in 1:size){\n  for(j in 1:size){\n    if( abs((Result2$W[i,j] - Result2$W_SE[i,j])*sqrt(Result2$n)) <  sig){\n      W[i,j] <- 0\n    }\n  }\n}\n\n# Checking W for zero restrictions with intervals\nW <- Result2$W\nsize <- nrow(W)\nalpha <- 0.05\nsig <- qt((1-alpha/2), (Result2$n-1))\nIntervalL <- matrix(0, size, size)\nIntervalU <- matrix(0, size, size)\nfor(i in 1:size){\n  for(j in 1:size){\n    IntervalL[i,j] <- W[i,j] - sig*Result2$W_SE[i,j]*(1/sqrt(Result2$n))\n    IntervalU[i,j] <- W[i,j] + sig*Result2$W_SE[i,j]*(1/sqrt(Result2$n))\n    if(IntervalL[i,j] < 0 & 0 < IntervalU[i,j]){\n      W[i,j] <- 0\n    }\n  }\n}\n\n# Testing if there is enough heteroscedasticity in the data\nbeta <- diag(Result2$Psi)[1:2]\nC <- matrix(c(1, 0, 0, -1), 2, 2)\nSigma <- Result2$InvFish[17:18,17:18]\nround(1 - pchisq(Wald.test(C, beta, Sigma), 4), 2)\nbeta <- diag(Result2$Psi)[c(1,3)]\nSigma <- Result2$InvFish[c(17,19),c(17,19)]\nround(1 - pchisq(Wald.test(C, beta, Sigma), 4), 2)\nbeta <- diag(Result2$Psi)[c(1,4)]\nSigma <- Result2$InvFish[c(17,20),c(17,20)]\nround(1 - pchisq(Wald.test(C, beta, Sigma), 4), 2)\nbeta <- diag(Result2$Psi)[c(2,3)]\nSigma <- Result2$InvFish[c(18,19),c(18,19)]\nround(1 - pchisq(Wald.test(C, beta, Sigma), 4), 2)\nbeta <- diag(Result2$Psi)[c(2,4)]\nSigma <- Result2$InvFish[c(18,20),c(18,20)]\nround(1 - pchisq(Wald.test(C, beta, Sigma), 4), 2)\nbeta <- diag(Result2$Psi)[c(3,4)]\nSigma <- Result2$InvFish[c(19,20),c(19,20)]\nround(1 - pchisq(Wald.test(C, beta, Sigma), 4), 2)\n# All diagonal elemnts of psi are distinct\n\n# restricted optimization\nOrdering <- F\nrest <- T\nBoot <- F\nchol.sky <- F\nnlag <- 10\nnames(TimeSeries) <- c('Date', 'I','GDP', 'CPI', 'IR')\nset.seed(41241)\nRestrictedResult <- ChangesVola()\nRestrictedResult$Psi\nRestrictedResult$Psi_SE\nRestrictedResult$W\nRestrictedResult$W_SE\n\n# restricted optimization with exact cholesky decomposition\nOrdering <- F\nrest <- T\nBoot <- F\nchol.sky <- T\nnlag <- 10\nnames(TimeSeries) <- c('Date', 'I','GDP', 'CPI', 'IR')\nset.seed(41241)\nRestrictedResultC <- ChangesVola()\nround(RestrictedResultC$Psi, 3)\nround(RestrictedResultC$Psi_SE, 3)\nround(RestrictedResultC$W, 3)\nround(RestrictedResultC$W_SE, 3)\n\n## Liklihood ratio test to test if the restrictions are useful\n# unrestricted model against partial restricted model\n2*(Result2$Lik - RestrictedResult$Lik)\ndf <- 5\n2*(Result2$Lik - RestrictedResult$Lik) > qchisq(0.95, df) # -> Liklihood is not unequal, retrictions holds\nround(1 - pchisq(2*(Result2$Lik - RestrictedResult$Lik), df), 3) \n# unrestricted model against cholesky model\n2*(Result2$Lik - RestrictedResultC$Lik)\ndf <- 6\n2*(Result2$Lik - RestrictedResultC$Lik) > qchisq(0.95, df) # -> Liklihood is not unequal, retrictions holds\nround(1 - pchisq(2*(Result2$Lik - RestrictedResultC$Lik), df), 3) \n# partial restricted against cholesky model\n2*(RestrictedResult$Lik - RestrictedResultC$Lik)\ndf <- 1\n2*(RestrictedResult$Lik - RestrictedResultC$Lik) > qchisq(0.95, df) # -> Liklihood is not unequal, retrictions holds\n# -> zero resrtrictions are supported by the data\n\n# Impulse response with changes in volatility by bootstrap procedure (time intensive)\nOrdering <- F\nrest <- T\nBoot <- T\nchol.sky <- F\nnlag <- 10\nnboot <- 500\nnames(TimeSeries) <- c('Date', 'I','GDP', 'CPI', 'IR')\nset.seed(41241)\nRestrictedImpulse <- ChangesVola()\nPlotShocksSingle(RestrictedImpulse$B, lowerbound, upperbound, horizon, nTS)\nggsave('./Ergebnisse/IrF_Heteroscedasticity.pdf', width = 12, height = 8)\n\n############## With long run interest rates #################\n# loading Data\nTimeSeries <- read.csv2('H:/Guido/Neues_Projekt/Daten_Projekt/USA/DataUSAreal.csv')\nTimeSeries <- TimeSeries[13:nrow(TimeSeries),1:5]\nLIR <- read.csv2('H:/Guido/Neues_Projekt/Daten_Projekt/USA/LongTermIR.csv')\nTimeSeries[,5] <- LIR[1:192,2]\n\n## Doing the analysis\nResults <- Analysis()\n\n# Results from Analysis\nResults$Data\nggsave('./Ergebnisse/TSPlot_GDPgrowth_longIR.pdf', width = 12, height = 8)\nResults$Impulse\nggsave('./Ergebnisse/Impact_RFI_longIR.pdf', width = 12, height = 8)\nResults$Window\nggsave('./Ergebnisse/RollingWindow_longIR.pdf', width = 12, height = 8)\n\n############## With capacity utilization #################\n# loading Data\nTimeSeries <- read.csv2('H:/Guido/Neues_Projekt/Daten_Projekt/USA/DataUSAreal.csv')\nTimeSeries <- TimeSeries[41:nrow(TimeSeries),1:5]\nTimeSeries <- na.omit(TimeSeries)\nUT <- read.csv2('H:/Guido/Neues_Projekt/Daten_Projekt/USA/CapUt.csv')\nTimeSeries[,3] <-UT[1:164,2]\n\n## Doing the analysis\nResults <- Analysis()\n\n# Results from Analysis\nResults$Data\nggsave('./Ergebnisse/TSPlot_GDPgrowth_CapUt.pdf', width = 12, height = 8)\nResults$Impulse\nggsave('./Ergebnisse/Impact_RFI_CapUt.pdf', width = 12, height = 8)\nResults$Window\nggsave('./Ergebnisse/RollingWindow_CapUt.pdf', width = 12, height = 8)\n",
    "created" : 1479744136942.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "216907234",
    "id" : "A1E69E67",
    "lastKnownWriteTime" : 1478462874,
    "path" : "~/Schreibtisch/Praktikum/DIW/Guido/Guido/Neues_Projekt/Codes/Real_USA/Stationary/Call.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}